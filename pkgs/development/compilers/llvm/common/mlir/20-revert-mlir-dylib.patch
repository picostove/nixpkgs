From 2ef7c1da3e420a90ae8c979483a41ba0b8c441a4 Mon Sep 17 00:00:00 2001
From: stove <stove@rivosinc.com>
Date: Fri, 27 Dec 2024 15:27:26 -0800
Subject: [PATCH] partial revert of ##119408

---
 tools/mlir-lsp-server/CMakeLists.txt | 3 +++
 tools/mlir-opt/CMakeLists.txt        | 2 ++
 tools/mlir-reduce/CMakeLists.txt     | 3 +++
 tools/mlir-rewrite/CMakeLists.txt    | 2 ++
 4 files changed, 10 insertions(+)

diff --git a/tools/mlir-lsp-server/CMakeLists.txt b/tools/mlir-lsp-server/CMakeLists.txt
index 6932e0f39779..65ff3ed10851 100644
--- a/tools/mlir-lsp-server/CMakeLists.txt
+++ b/tools/mlir-lsp-server/CMakeLists.txt
@@ -55,6 +55,9 @@ set(LIBS
 
 add_mlir_tool(mlir-lsp-server
   mlir-lsp-server.cpp
+
+  DEPENDS
+  ${LIBS}
   )
 mlir_target_link_libraries(mlir-lsp-server PRIVATE ${LIBS})
 target_link_libraries(mlir-lsp-server PRIVATE ${test_libs})
diff --git a/tools/mlir-opt/CMakeLists.txt b/tools/mlir-opt/CMakeLists.txt
index 3563d66fa9e7..25da0096f0f5 100644
--- a/tools/mlir-opt/CMakeLists.txt
+++ b/tools/mlir-opt/CMakeLists.txt
@@ -100,6 +100,8 @@ add_mlir_library(MLIRMlirOptMain
 add_mlir_tool(mlir-opt
   mlir-opt.cpp
 
+  DEPENDS
+  ${LIBS}
   SUPPORT_PLUGINS
   )
 mlir_target_link_libraries(mlir-opt PRIVATE ${LIBS})
diff --git a/tools/mlir-reduce/CMakeLists.txt b/tools/mlir-reduce/CMakeLists.txt
index d71ac861a29d..23996c6b0c69 100644
--- a/tools/mlir-reduce/CMakeLists.txt
+++ b/tools/mlir-reduce/CMakeLists.txt
@@ -18,6 +18,9 @@ set(LIBS
 
 add_mlir_tool(mlir-reduce
   mlir-reduce.cpp
+
+  DEPENDS
+  ${LIBS}
   )
 
 mlir_target_link_libraries(mlir-reduce PRIVATE ${LIBS})
diff --git a/tools/mlir-rewrite/CMakeLists.txt b/tools/mlir-rewrite/CMakeLists.txt
index 216491eb432a..7ae0a4249541 100644
--- a/tools/mlir-rewrite/CMakeLists.txt
+++ b/tools/mlir-rewrite/CMakeLists.txt
@@ -23,6 +23,8 @@ include_directories(../../../clang/include)
 add_mlir_tool(mlir-rewrite
   mlir-rewrite.cpp
 
+  DEPENDS
+  ${LIBS}
   SUPPORT_PLUGINS
   )
 mlir_target_link_libraries(mlir-rewrite PRIVATE ${LIBS})
-- 
2.34.1

